\documentclass[12pt, a4paper]{article}

\usepackage{amsmath}
\usepackage{array}
\usepackage{amsmath}
\usepackage[portuguese]{babel}
\usepackage{chngpage}
\usepackage{float}
\usepackage[a4paper, margin=2cm]{geometry}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{setspace}
\usepackage{xcolor}

\lstdefinestyle{codestyle}{
    commentstyle=\color{teal},
    keywordstyle=\color{blue},
    numberstyle=\ttfamily\color{gray},
    stringstyle=\color{red},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,
    breaklines=false,
    keepspaces=true,
    numbers=none,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=4
}
\lstset{style=codestyle}

\title{\Huge \textbf{Computação Gráfica \\ \Large Trabalho Prático -- Fase II}}
\date{30 de março 2025}
\author{Grupo 3}

\begin{document}

\begin{center}
    \includegraphics[width=0.25\textwidth]{res/cover/EE-C.eps}
\end{center}

\chardef\_=`_
\onehalfspacing
\setlength{\parskip}{\baselineskip}
\setlength{\parindent}{0pt}
\def\arraystretch{1.5}

{\let\newpage\relax\maketitle}
\maketitle
\thispagestyle{empty}

\vspace*{\fill}

\begin{adjustwidth}{-2cm}{-2cm} % These values only need to be large enough to center the table
    \begin{center}
        \begin{tabular}{>{\centering}p{0.25\textwidth}
                        >{\centering}p{0.25\textwidth}
                        >{\centering}p{0.25\textwidth}
                        >{\centering\arraybackslash}p{0.25\textwidth}}
            \includegraphics[width=3.5cm]{res/cover/A104437.png} &
            \includegraphics[width=3.5cm]{res/cover/A104348.png} &
            \includegraphics[width=3.5cm]{res/cover/A90817.png} &
            \includegraphics[width=3.5cm]{res/cover/A104179.png} \\

            Ana Oliveira & Humberto Gomes & Mariana Cristino & Sara Lopes \\
            A104437      & A104348        & A90817           & A104179
        \end{tabular}
    \end{center}
\end{adjustwidth}

\pagebreak

\begin{abstract}
    \textbf{\color{red} TODO - resumo}
\end{abstract}

\section{Engine}

\subsection{Câmara Livre}

A câmara livre permite que o utilizador se desloque de forma intuitiva, sendo semelhante à de
jogos de exploração na primeira pessoa, como simuladores de voo, e ambientes de realidade
virtual.
De seguida, descrevem-se os diferentes tipos de movimento suportados.

\subsubsection{Movimentação}

A câmara pode deslocar-se e rodar de forma contínua no espaço tridimensional, sendo os seus
movimentos definidos pelos seguintes vetores:

\begin{itemize}
    \item \textbf{Vetor} $\vec{f}$: Direção do olhar da câmara.
    \item \textbf{Vetor} $\vec{r}$: Direção perpendicular ao vetor $\vec{f}$, ao
          longo do plano horizontal.
    \item \textbf{Vetor} $\vec{up}$: Aproximação da vertical da câmara.
\end{itemize}

A posição da câmara, $\vec{p}$, é atualizada de acordo com a seguinte equação:

\[
\vec{p} \gets \vec{p} + v \cdot \vec{f}'
\]

onde $v$ representa a velocidade e $\vec{f}'$ a direção, que depende do movimento escolhido
pelo utilizador:

\begin{itemize}
    \item \textbf{Translação horizontal}: O movimento para a frente e para trás ocorre ao longo
          do vetor $\textbf{front}$, $\vec{f}$, enquanto o movimento lateral ocorre ao longo do
          vetor $\textbf{right}$, $\vec{r}$.
    \item \textbf{Translação vertical}: O movimento vertical acontece ao longo do vetor
          $\textbf{up}$, $\vec{up}$, permitindo ao utilizador subir e descer.
    \item \textbf{Rotação}: A orientação da câmara é definida pelos ângulos $\textbf{yaw}$,
          $\theta$, responsável pela rotação horizontal, e $\textbf{pitch}$, $\phi$, responsável
          pela inclinação vertical, que determinam a direção do vetor $\vec{f}$.
\end{itemize}

\subsubsection{Atualização da Direção da Câmara}

A atualização da orientação da câmara obtém-se através da conversão dos ângulos $\theta$ e
$\phi$ para um vetor de direção tridimensional. A relação entre os ângulos e os
componentes do vetor $\vec{f}$ é dada por:

\[
\begin{aligned}
    \text{f}_x &= \cos(\phi) \cdot \cos(\theta) \\
    \text{f}_y &= \sin(\phi) \\
    \text{f}_z &= \cos(\phi) \cdot \sin(\theta)
\end{aligned}
\]

Após serem calculados os componentes do vetor, este é normalizado, uma vez que é necessário
garantir que este mantém um comprimento unitário. Esta normalização é fundamental para garantir
que a câmara mantém uma velocidade constante em qualquer direção.

Além disso, foram tomadas medidas para prevenir o $\mathbf{gimbal}$  $\mathbf{lock}$.
Este é um problema que ocorre quando dois eixos de rotação se alinham, ou seja, quando $\phi$
atinge \( 90^\circ \) ou \( -90^\circ \). Além disso, no caso de $\phi$ exceder \( |90^\circ| \),
o sinal da componente vertical inverte-se, o que provoca uma inversão dos eixos de controlo.
Para resolver estes 2 problemas, impusemos o seguinte limite:

$$
-89^\circ \leq \phi \leq 89^\circ
$$

Isto impede que a câmara olhe completamente para cima ou para baixo, garantindo que o vetor
$\vec{up}$ mantenha uma orientação bem definida e evitando a perda de controlo sobre a rotação
horizontal.

O novo ponto de destino da câmara $\mathbf{lookAt}$, $\l$, é atualizado através da soma do vetor
normalizado e da posição atual:

\[
l = \vec{p} + \vec{f}
\]

Além disso, os vetores $\vec{r}$ e $\vec{up}$ são recalculados para garantir que a
orientação da câmara permanece coerente. O vetor $\vec{r}$ é obtido como o produto
vetorial entre um vetor de referência vertical $(0,1,0)$ e o vetor  $\vec{f}$:

\[
    \vec{r} = \vec{f} \times (0,1,0)
\]

Por fim, o vetor $\vec{up}$ é recalculado para ser ortogonal aos outros dois vetores:

\[
    \vec{up} = \vec{r} \times \vec{f}
\]

Isto assegura que os movimentos laterais, verticais e de rotação permanecem coerentes em
qualquer orientação da câmara, garantindo um comportamento previsível para o utilizador.

\subsubsection{Controlo por parte do utilizador}

O utilizador pode controlar a câmara de forma intuitiva, utilizando o teclado para movimentação
e as setas direcionais para rotação:

\begin{itemize}
    \item \textbf{W/S:} Movem a câmara para a frente/trás.
    \item \textbf{A/D:} Movem a câmara para os lados.
    \item \textbf{Espaço (SPACE):} Sobe a câmara.
    \item \textbf{Shift Esquerdo (LEFT SHIFT):} Desce a câmara.
    \item \textbf{Seta Esquerda/Direita:} Roda a câmara para a esquerda/direita.
    \item \textbf{Seta Cima/Baixo:} Inclina a câmara para cima/baixo.
\end{itemize}

\section{Transformações}

\textbf{\color{red} TODO - transformações}

\section{Modelo estático do sistema solar}

\textbf{\color{red} TODO - sistema solar}

\section{Extras}

\textbf{\color{red} TODO - extras}

\section{Resultados obtidos}

\textbf{\color{red} TODO - resultados}

\section{Conclusão e Trabalho Futuro}

\textbf{\color{red} TODO - conclusão}

\begingroup
\section{Bibliografia}
\renewcommand{\section}[2]{}

\begin{thebibliography}{9}
    \bibitem{exemplo}
        \href{https://youtu.be/dQw4w9WgXcQ}{Um item de exemplo na bibliografia}
\end{thebibliography}
\endgroup

\end{document}
